webpackJsonp([1],{FBSW:function(e,t){},Mx55:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),a=n("zL8q"),o=n.n(a),i=(n("tvR6"),n("mvHQ")),r=n.n(i),c=n("MJLE"),l=n.n(c),u={name:"app-nav-menu",data:function(){return{dialogVisible:!1}},methods:{showCert:function(){this.dialogVisible=!0,this.$nextTick(function(){var e=document.getElementById("qrcode");e.innerText="";var t=location.protocol+"://"+location.host+location.pathname;t.lastIndexOf("/")!==t.length-1&&(t+="/"),t+="public/mity-proxy.crt",new l.a(e,t)})},downloadCert:function(){location.href="public/mitm-proxy.crt"}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-menu",{attrs:{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",mode:"horizontal"}},[n("el-menu-item",{attrs:{index:"/"},on:{click:e.showCert}},[e._v("Root CA\n    ")])],1),e._v(" "),n("el-dialog",{attrs:{title:"Download Root CA",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("div",{attrs:{id:"qrcode"}})]),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-button",{attrs:{type:"primary"},on:{click:e.downloadCert}},[e._v("download")])],1)],1)],1)],1)},staticRenderFns:[]};var p=n("VU/8")(u,d,!1,function(e){n("pYe9")},"data-v-310d17ec",null).exports,v=1e3,_=1001,h=1002,b=2e3,f=2001,y=2002,m=3e3,x=n("V8mf"),g=n.n(x),T=(n("FBSW"),n("xrTZ").Base64),w=n("jMz+"),k=n("jMz+").css,S=n("jMz+").html,q={name:"App",data:function(){return{socket:null,timer:null,enableCapture:!0,captureStatusText:"stop",showMaxTransactionNum:500,transactions:[],dialogVisible:!1,dialogFullScreen:!1,activeTab:"headers",activeTx:null,activePanel:"general"}},components:{appNavMenu:p},created:function(){this.initWebSocket()},destroyed:function(){this.timer&&clearInterval(this.timer),this.socket&&this.socket.close()},computed:{showTransactions:function(){return this.transactions}},methods:{getWebSocketURL:function(){var e="ws://"+location.host+location.pathname;return e.lastIndexOf("/")!==e.length-1&&(e+="/"),e},initWebSocket:function(){this.socket=new WebSocket(this.getWebSocketURL()+"ws"),this.socket.onopen=this.webSocketOpen,this.socket.onmessage=this.webSocketReceive,this.socket.onerror=this.webSocketError,this.socket.onclose=this.webSocketClose},webSocketOpen:function(){console.log("webSocket连接成功"),this.heartBeat()},webSocketReceive:function(e){var t=JSON.parse(e.data);this.dispatchEvent(t.type,t.payload)},webSocketSend:function(e,t){var n={type:e,payload:t};this.socket.send(r()(n))},webSocketClose:function(){console.log("webSocket连接关闭"),this.initWebSocket()},webSocketError:function(){console.log("webSocket发生错误")},dispatchEvent:function(e,t){switch(e){case b:break;case f:this.responseReplay(t);break;case y:this.responseTransaction(t);break;case m:this.pushTransaction(t);break;default:console.log("webSocket不支持的消息类型",e,t)}},heartBeat:function(){var e=this;setInterval(function(){e.requestPing()},2e4)},requestPing:function(){this.webSocketSend(v,{})},requestReplay:function(e){this.webSocketSend(_,{id:e})},requestTransaction:function(e){this.webSocketSend(h,{id:e})},clearTransactions:function(){this.transactions=[]},responseReplay:function(e){},responseTransaction:function(e){var t=this;e.request.body.is_image=this.isImageType(e.request.body.content_type),e.response.body.is_image=this.isImageType(e.response.body.content_type),e.request.query_param=this.parseQueryParams(e.request.query_param),this.decodeBodyIfNeed(e),e.request.body.content=this.formatCode(e.request.body.content_type,e.request.body.content),e.response.body.content=this.formatCode(e.response.body.content_type,e.response.body.content),this.activeTx=e,this.dialogVisible=!0,setTimeout(function(){t.highlightCode()},1e3)},decodeBodyIfNeed:function(e){if(!e.request.body.is_binary&&!e.request.body.is_image)switch(e.request.body.content=T.decode(e.request.body.content),e.request.body.content_type){case"application/x-www-form-urlencoded":e.request.body.content=this.parseQueryParams(e.request.body.content)}""!==e.response.err||e.response.body.is_binary||e.response.body.is_image||(e.response.body.content=T.decode(e.response.body.content))},isImageType:function(e){return 0===e.indexOf("image/")},pushTransaction:function(e){this.enableCapture&&(this.transactions.length>=this.showMaxTransactionNum&&this.transactions.pop(),this.transactions.unshift(e))},toggleCapture:function(){this.enableCapture=!this.enableCapture,this.enableCapture?this.captureStatusText="stop":this.captureStatusText="resume"},tableRowClassName:function(e){return e.response_err||e.response_status_code>=400?"warning-row":""},clickRow:function(e){this.activeTx=null,this.requestTransaction(e.id),this.activeTab="headers",this.activePanel="general"},parseQueryParams:function(e){var t={},n=e.split("&");return 0===n.length?t:(n.forEach(function(e){var n=e.split("=");switch(n.length){case 1:""!==n[0]&&(t[n[0]]="");break;case 2:""!==n[0]&&(t[n[0]]=n[1])}}),t)},highlightCode:function(){document.querySelectorAll("pre code").forEach(function(e){g.a.highlightBlock(e)})},formatCode:function(e,t){switch(e){case"text/html":case"text/plain":case"text/xml":case"application/xml":t=0===t.indexOf("{")&&t.lastIndexOf("}")===t.length-1?w(t):S(t);break;case"text/javascript":case"application/json":case"application/javascript":case"application/x-javascript":t=w(t);break;case"text/css":t=k(t)}return t}},filters:{formatDuration:function(e){return(e=e/1e3/1e3)<1e3?e.toFixed(2)+"ms":(e/1e3).toFixed(2)+"s"},formatBodySize:function(e){return e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"KB":(e/1048576).toFixed(2)+"M"},subString:function(e){return e.length<30?e:e.substring(e.length-27)},decodeURI:function(e){return e}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("app-nav-menu")],1),e._v(" "),n("el-main",[n("div",{attrs:{id:"main-container"}},[n("el-dialog",{attrs:{title:"Transaction",visible:e.dialogVisible,width:"80%",center:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.activeTx?n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.requestReplay(e.activeTx.id)}}},[e._v("replay")])],1)],1):e._e(),e._v(" "),e.activeTx?n("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"Headers",name:"headers"}},[n("el-collapse",{model:{value:e.activePanel,callback:function(t){e.activePanel=t},expression:"activePanel"}},[n("el-collapse-item",{attrs:{title:"General",name:"general"}},[n("p",[n("span",{staticClass:"bold"},[e._v("Request URL: ")]),e._v(" "+e._s(e.activeTx.request.url)+"\n                ")]),e._v(" "),n("p",[n("span",{staticClass:"bold"},[e._v("Request Method: ")]),e._v(" "+e._s(e.activeTx.request.method)+"\n                ")]),e._v(" "),e.activeTx.response.err?e._e():n("p",[n("span",{staticClass:"bold"},[e._v("Status Code: ")]),e._v(" "+e._s(e.activeTx.response.status_code)+"\n                ")]),e._v(" "),n("p",[e.activeTx.server_ip?n("span",{staticClass:"bold"},[e._v("Server IP: ")]):e._e(),e._v(" "+e._s(e.activeTx.server_ip)+"\n              ")]),e._v(" "),n("p",[n("span",{staticClass:"bold"},[e._v("Client IP: ")]),e._v(" "+e._s(e.activeTx.client_ip)+"\n                ")]),e._v(" "),e.activeTx.response.err?n("p",{staticStyle:{color:"red"}},[e._v("\n                  "+e._s(e.activeTx.response.err)+"\n                ")]):e._e()]),e._v(" "),e.activeTx.response.err?e._e():n("el-collapse-item",{attrs:{title:"Response Headers",name:"responseHeaders"}},[e._l(e.activeTx.response.header,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+": ")]),e._v(" "+e._s(e._f("decodeURI")(t.join(";")))+"\n                ")])]})],2),e._v(" "),n("el-collapse-item",{attrs:{title:"Request Headers",name:"requestHeaders"}},[e._l(e.activeTx.request.header,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+": ")]),e._v(" "+e._s(e._f("decodeURI")(t.join(";")))+"\n                  ")])]})],2),e._v(" "),n("el-collapse-item",{attrs:{title:"Query String Parameters",name:"queryStringParameters"}},[e._l(e.activeTx.request.query_param,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+":")]),e._v(" "+e._s(t)+"\n                  ")])]})],2),e._v(" "),"GET"!==e.activeTx.request.method?n("el-collapse-item",{attrs:{title:"Request payload",name:"requestPayload"}},["application/x-www-form-urlencoded"===e.activeTx.request.body.content_type?n("span",[e._l(e.activeTx.request.body.content,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+":")]),e._v(" "+e._s(t)+"\n                  ")])]})],2):e.activeTx.request.body.is_binary?n("span",[e._v("\n                  "+e._s(e.activeTx.request.body.content)+"\n                ")]):n("span",[n("pre",[n("code",[e._v(e._s(e.activeTx.request.body.content))])])])]):e._e()],1)],1),e._v(" "),e.activeTx.response.err?e._e():n("el-tab-pane",{attrs:{label:"Preview",name:"preview"}},[n("p",[e.activeTx.response.body.is_image?n("span",[n("img",{attrs:{src:"data:"+e.activeTx.response.body.content_type+";base64,"+e.activeTx.response.body.content}})]):e.activeTx.response.body.is_binary?e._e():n("span",[n("pre",[n("code",[e._v(e._s(e.activeTx.response.body.content))])])])])]),e._v(" "),e.activeTx.response.err?e._e():n("el-tab-pane",{attrs:{label:"Response",name:"response"}},[n("p",[e._v("\n              "+e._s(e.activeTx.response.body.content)+"\n            ")])])],1):e._e()],1),e._v(" "),n("div",[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("el-button",{attrs:{type:"primary"},on:{click:e.toggleCapture}},[e._v(e._s(e.captureStatusText))]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.clearTransactions}},[e._v("clear")])],1)],1)],1),e._v(" "),n("div",[n("table",[n("thead",[n("th",{staticStyle:{width:"20%"}},[e._v("Name")]),e._v(" "),n("th",{staticStyle:{width:"20%"}},[e._v("Host")]),e._v(" "),n("th",{staticStyle:{width:"10%"}},[e._v("Method")]),e._v(" "),n("th",{staticStyle:{width:"10%"}},[e._v("Status")]),e._v(" "),n("th",{staticStyle:{width:"20%"}},[e._v("Type")]),e._v(" "),n("th",{staticStyle:{width:"10%"}},[e._v("Size")]),e._v(" "),n("th",{staticStyle:{width:"10%"}},[e._v("Time")])]),e._v(" "),n("tbody",e._l(e.showTransactions,function(t){return n("tr",{key:t.id,on:{click:function(n){e.clickRow(t)}}},[n("td",[e._v("\n                "+e._s(e._f("subString")(t.path))+"\n              ")]),e._v(" "),n("td",[e._v("\n                "+e._s(e._f("subString")(t.host))+"\n              ")]),e._v(" "),n("td",[e._v("\n                "+e._s(t.method)+"\n              ")]),e._v(" "),n("td",[t.response_err?n("span",{staticStyle:{color:"red"}},[e._v("\n                    error\n                  ")]):n("span",[e._v("\n                    "+e._s(t.response_status_code)+"\n                  ")])]),e._v(" "),n("td",[e._v("\n                "+e._s(t.response_content_type)+"\n              ")]),e._v(" "),n("td",[e._v("\n                "+e._s(e._f("formatBodySize")(t.response_len))+"\n              ")]),e._v(" "),n("td",[e._v("\n                "+e._s(e._f("formatDuration")(t.duration))+"\n              ")])])}))])])],1)])],1)},staticRenderFns:[]};var R=n("VU/8")(q,C,!1,function(e){n("Mx55")},null,null).exports;s.default.config.productionTip=!1,s.default.use(o.a),s.default.directive("focus",{inserted:function(e){e.focus()}}),s.default.prototype.$appConfirm=function(e){this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e()})},s.default.filter("formatTime",function(e){var t=function(e){return e>=10?e:"0"+e},n=new Date(e),s=n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+" "+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds());return 0!==s.indexOf("20")?"":s}),new s.default({el:"#app",components:{App:R},template:"<App/>"})},pYe9:function(e,t){},tvR6:function(e,t){}},["NHnr"]);