webpackJsonp([1],{FBSW:function(e,t){},KuvU:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("7+uW"),a=n("zL8q"),o=n.n(a),r=(n("tvR6"),n("mvHQ")),i=n.n(r),c={name:"app-nav-menu",data:function(){return{}},methods:{downloadCert:function(){location.href="public/mitm-proxy.crt"}}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-menu",{attrs:{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",mode:"horizontal"}},[t("el-menu-item",{attrs:{index:"/"},on:{click:this.downloadCert}},[this._v("Root CA\n    ")])],1)],1)},staticRenderFns:[]};var u=n("VU/8")(c,l,!1,function(e){n("SrkB")},"data-v-6155fe5a",null).exports,p=1e3,d=1001,v=1002,_=2e3,f=2001,b=2002,h=3e3,m=n("V8mf"),y=n.n(m),x=(n("FBSW"),n("xrTZ").Base64),T=n("jMz+"),g=n("jMz+").css,k=n("jMz+").html,w={name:"App",data:function(){return{socket:null,timer:null,enableCapture:!0,captureStatusText:"stop",showMaxTransactionNum:1e3,transactions:[],dialogVisible:!1,dialogFullScreen:!1,activeTab:"headers",activeTx:null,activePanel:"general"}},components:{appNavMenu:u},created:function(){this.initWebSocket()},destroyed:function(){this.timer&&clearInterval(this.timer),this.socket&&this.socket.close()},computed:{showTransactions:function(){return this.transactions}},methods:{getWebSocketURL:function(){var e="ws://"+location.host+location.pathname;return e.lastIndexOf("/")!==e.length-1&&(e+="/"),e},initWebSocket:function(){this.socket=new WebSocket(this.getWebSocketURL()+"ws"),this.socket.onopen=this.webSocketOpen,this.socket.onmessage=this.webSocketReceive,this.socket.onerror=this.webSocketError,this.socket.onclose=this.webSocketClose},webSocketOpen:function(){console.log("webSocket连接成功"),this.heartBeat()},webSocketReceive:function(e){var t=JSON.parse(e.data);this.dispatchEvent(t.type,t.payload)},webSocketSend:function(e,t){var n={type:e,payload:t};this.socket.send(i()(n))},webSocketClose:function(){console.log("webSocket连接关闭"),this.initWebSocket()},webSocketError:function(){console.log("webSocket发生错误")},dispatchEvent:function(e,t){switch(e){case _:break;case f:this.responseReplay(t);break;case b:this.responseTransaction(t);break;case h:this.pushTransaction(t);break;default:console.log("webSocket不支持的消息类型",e,t)}},heartBeat:function(){var e=this;setInterval(function(){e.requestPing()},2e4)},requestPing:function(){this.webSocketSend(p,{})},requestReplay:function(e){this.webSocketSend(d,{id:e})},requestTransaction:function(e){this.webSocketSend(v,{id:e})},clearTransactions:function(){this.transactions=[]},responseReplay:function(e){},responseTransaction:function(e){var t=this;e.request.body.is_image=this.isImageType(e.request.body.content_type),e.response.body.is_image=this.isImageType(e.response.body.content_type),e.request.query_param=this.parseQueryParams(e.request.query_param),this.decodeBodyIfNeed(e),e.request.body.content=this.formatCode(e.request.body.content_type,e.request.body.content),e.response.body.content=this.formatCode(e.response.body.content_type,e.response.body.content),this.activeTx=e,this.dialogVisible=!0,setTimeout(function(){t.highlightCode()},1e3)},decodeBodyIfNeed:function(e){if(!e.request.body.is_binary&&!e.request.body.is_image)switch(e.request.body.content=x.decode(e.request.body.content),e.request.body.content_type){case"application/x-www-form-urlencoded":e.request.body.content=this.parseQueryParams(e.request.body.content)}""!==e.response.err||e.response.body.is_binary||e.response.body.is_image||(e.response.body.content=x.decode(e.response.body.content))},isImageType:function(e){return 0===e.indexOf("image/")},pushTransaction:function(e){this.enableCapture&&(this.transactions.length>=this.showMaxTransactionNum&&this.transactions.pop(),this.transactions.unshift(e))},toggleCapture:function(){this.enableCapture=!this.enableCapture,this.enableCapture?this.captureStatusText="stop":this.captureStatusText="resume"},tableRowClassName:function(e){var t=e.row;return t.response_err||t.response_status_code>=400?"warning-row":""},clickRow:function(e){this.activeTx=null,this.requestTransaction(e.id),this.activeTab="headers",this.activePanel="general"},parseQueryParams:function(e){var t={},n=e.split("&");return 0===n.length?t:(n.forEach(function(e){var n=e.split("=");switch(n.length){case 1:""!==n[0]&&(t[n[0]]="");break;case 2:""!==n[0]&&(t[n[0]]=n[1])}}),t)},highlightCode:function(){document.querySelectorAll("pre code").forEach(function(e){y.a.highlightBlock(e)})},formatCode:function(e,t){switch(e){case"text/html":case"text/plain":case"text/xml":case"application/xml":t=0===t.indexOf("{")&&t.lastIndexOf("}")===t.length-1?T(t):k(t);break;case"text/javascript":case"application/json":case"application/javascript":case"application/x-javascript":t=T(t);break;case"text/css":t=g(t)}return t}},filters:{formatDuration:function(e){return(e=e/1e3/1e3)<1e3?e.toFixed(2)+"ms":(e/1e3).toFixed(2)+"s"},formatBodySize:function(e){return e<1024?e+"B":e>=1024&&e<1048576?(e/1024).toFixed(2)+"KB":(e/1048576).toFixed(2)+"M"},subString:function(e){return e.length<30?e:e.substring(e.length-27)},decodeURI:function(e){return e}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("app-nav-menu")],1),e._v(" "),n("el-main",[n("div",{attrs:{id:"main-container"}},[n("el-dialog",{attrs:{title:"Transaction",visible:e.dialogVisible,width:"80%",center:!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.activeTx?n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.requestReplay(e.activeTx.id)}}},[e._v("replay")])],1)],1):e._e(),e._v(" "),e.activeTx?n("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"Headers",name:"headers"}},[n("el-collapse",{model:{value:e.activePanel,callback:function(t){e.activePanel=t},expression:"activePanel"}},[n("el-collapse-item",{attrs:{title:"General",name:"general"}},[n("p",[n("span",{staticClass:"bold"},[e._v("Request URL: ")]),e._v(" "+e._s(e.activeTx.request.url)+"\n                ")]),e._v(" "),n("p",[n("span",{staticClass:"bold"},[e._v("Request Method: ")]),e._v(" "+e._s(e.activeTx.request.method)+"\n                ")]),e._v(" "),e.activeTx.response.err?e._e():n("p",[n("span",{staticClass:"bold"},[e._v("Status Code: ")]),e._v(" "+e._s(e.activeTx.response.status_code)+"\n                ")]),e._v(" "),n("p",[e.activeTx.server_ip?n("span",{staticClass:"bold"},[e._v("Server IP: ")]):e._e(),e._v(" "+e._s(e.activeTx.server_ip)+"\n              ")]),e._v(" "),n("p",[n("span",{staticClass:"bold"},[e._v("Client IP: ")]),e._v(" "+e._s(e.activeTx.client_ip)+"\n                ")]),e._v(" "),e.activeTx.response.err?n("p",{staticStyle:{color:"red"}},[e._v("\n                  "+e._s(e.activeTx.response.err)+"\n                ")]):e._e()]),e._v(" "),e.activeTx.response.err?e._e():n("el-collapse-item",{attrs:{title:"Response Headers",name:"responseHeaders"}},[e._l(e.activeTx.response.header,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+": ")]),e._v(" "+e._s(e._f("decodeURI")(t.join(";")))+"\n                ")])]})],2),e._v(" "),n("el-collapse-item",{attrs:{title:"Request Headers",name:"requestHeaders"}},[e._l(e.activeTx.request.header,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+": ")]),e._v(" "+e._s(e._f("decodeURI")(t.join(";")))+"\n                  ")])]})],2),e._v(" "),n("el-collapse-item",{attrs:{title:"Query String Parameters",name:"queryStringParameters"}},[e._l(e.activeTx.request.query_param,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+":")]),e._v(" "+e._s(t)+"\n                  ")])]})],2),e._v(" "),"GET"!==e.activeTx.request.method?n("el-collapse-item",{attrs:{title:"Request payload",name:"requestPayload"}},["application/x-www-form-urlencoded"===e.activeTx.request.body.content_type?n("span",[e._l(e.activeTx.request.body.content,function(t,s){return[n("p",{key:s},[n("span",{staticClass:"bold"},[e._v(e._s(s)+":")]),e._v(" "+e._s(t)+"\n                  ")])]})],2):e.activeTx.request.body.is_binary?n("span",[e._v("\n                  "+e._s(e.activeTx.request.body.content)+"\n                ")]):n("span",[n("pre",[n("code",[e._v(e._s(e.activeTx.request.body.content))])])])]):e._e()],1)],1),e._v(" "),e.activeTx.response.err?e._e():n("el-tab-pane",{attrs:{label:"Preview",name:"preview"}},[n("p",[e.activeTx.response.body.is_image?n("span",[n("img",{attrs:{src:"data:"+e.activeTx.response.body.content_type+";base64,"+e.activeTx.response.body.content}})]):e.activeTx.response.body.is_binary?e._e():n("span",[n("pre",[n("code",[e._v(e._s(e.activeTx.response.body.content))])])])])]),e._v(" "),e.activeTx.response.err?e._e():n("el-tab-pane",{attrs:{label:"Response",name:"response"}},[n("p",[e._v("\n              "+e._s(e.activeTx.response.body.content)+"\n            ")])])],1):e._e()],1),e._v(" "),n("div",[n("el-row",{attrs:{type:"flex",justify:"end"}},[n("el-col",{attrs:{span:4}},[n("el-button",{attrs:{type:"primary"},on:{click:e.toggleCapture}},[e._v(e._s(e.captureStatusText))]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.clearTransactions}},[e._v("clear")])],1)],1)],1),e._v(" "),n("div",[n("el-table",{attrs:{"row-class-name":e.tableRowClassName,data:e.showTransactions,"highlight-current-row":!0,"current-row-key":"id"},on:{"cell-click":e.clickRow}},[n("el-table-column",{attrs:{label:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("subString")(t.row.path))+"\n            ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Host"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("subString")(t.row.host))+"\n            ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"method",label:"Method"}}),e._v(" "),n("el-table-column",{attrs:{label:"Status"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.response_err?n("span",[e._v("\n                error\n              ")]):n("span",[e._v("\n                "+e._s(t.row.response_status_code)+"\n              ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"response_content_type",label:"Type"}}),e._v(" "),n("el-table-column",{attrs:{label:"Size"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatBodySize")(t.row.response_len))+"\n            ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"Time"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("formatDuration")(t.row.duration))+"\n            ")]}}])})],1)],1)],1)])],1)},staticRenderFns:[]};var q=n("VU/8")(w,S,!1,function(e){n("KuvU")},null,null).exports;s.default.config.productionTip=!1,s.default.use(o.a),s.default.directive("focus",{inserted:function(e){e.focus()}}),s.default.prototype.$appConfirm=function(e){this.$confirm("确定执行此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e()})},s.default.filter("formatTime",function(e){var t=function(e){return e>=10?e:"0"+e},n=new Date(e),s=n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+" "+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds());return 0!==s.indexOf("20")?"":s}),new s.default({el:"#app",components:{App:q},template:"<App/>"})},SrkB:function(e,t){},tvR6:function(e,t){}},["NHnr"]);